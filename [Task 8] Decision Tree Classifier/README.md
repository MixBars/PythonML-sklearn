# <b>Задание 8</b>

В этом упражнении вам предлагается построить классификатор на наборе данных, полученных Национальным институтом диабета, болезней органов пищеварения и почек (National Institute of Diabetes and Digestive and Kidney Diseases). Цель состоит в том, чтобы ответить на вопрос: есть ли у пациента диабет, основываясь на определенных диагностических измерениях, включенных в набор данных, который получен из исходной базы данных наложением нескольких ограничений. В частности, в рассматриваемых в задании данных, все пациенты — женщины не менее 21 года индийского происхождения Пима.

Набор данных состоит из таких предикторов, как количество беременностей у пациентки, индекс массы тела, уровень инсулина, возраст и так далее. Отклик принимает два значение — больна ```1``` диабетом или нет ```0```.

В задачах используйте реализацию ДПР из библиотеки sklearn:
```python
from sklearn.tree import DecisionTreeClassifier
```
Для визуализации дерева принятия решений можете воспользоваться библиотекой ```graphviz``` и кодом (где ```x — тренировочный набор данных```, ```clf — обученное ДПР```):
```python
from sklearn.tree import export_graphviz
import graphviz
columns = list(x.columns)
export_graphviz(clf, out_file='tree.dot', 
                feature_names=columns,
                class_names=['0', '1'],
                rounded = True, proportion = False, 
                precision = 2, filled = True, label='all')

with open('tree.dot') as f:
    dot_graph = f.read()

graphviz.Source(dot_graph)
```

Отделите от исходного набора данных первые ```620 строк```.

<b>1. Найдите число строк в получившейся выборке относящихся к классу ```0``` (пациент не болен диабетом)</b>

Разделите полученную выборку на тренировочную и тестовую части, в отношении ```80/20``` (первые ```80% строк — тренировочный набор данных```, остальные ```20% — тестовый```). Предикторами служат столбцы ```Pregnancies```, ```Glucose```, ```BloodPressure```, ```SkinThickness```, ```Insulin```, ```BMI```, ```DiabetesPedigreeFunction```, ```Age```. Отклик — ```Outcome```.

Обучите классификатор, используя ```DecisionTreeClassifier``` с параметрами ```criterion='entropy'```, ```max_leaf_nodes = 15```, ```min_samples_leaf = 10``` и ```random_state = 2020```.

Изучите получившееся дерево принятия решений.

<b>2. Найдите глубину дерева</b>

<b>3. Найдите по какому предиктору выполнено разделение на последнем уровне дерева принятия решений</b>

<b>4. Найдите значение разделения для указанного предиктора</b>

Оцените модель с помощью тестовых данных.

<b>5. Найдите долю правильных ответов</b>

<b>6. Найдите среднее значение метрик ![изображение](https://user-images.githubusercontent.com/39648424/199190874-2ac2ede8-d6cf-451b-a8a2-f8af0186449a.png) ```Macro-F1```</b>

Выполните предсказание для пациентов (указаны номера строк, нумерация с нуля):

<b>7. Выполните предсказание для пациента с ```№754``` из начального набора данных</b>

<b>8. Выполните предсказание для пациента с ```№756``` из начального набора данных</b>

<b>9. Выполните предсказание для пациента с ```№759``` из начального набора данных</b>

<b>10. Выполните предсказание для пациента с ```№721``` из начального набора данных</b>
