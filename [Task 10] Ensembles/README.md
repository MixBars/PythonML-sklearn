# <b>Задание 10</b>

В данном упражнении вам предстоит решить уже знакомую задачу классификации изображений – отделить изображения кошек от изображений собак, используя ансамбль моделей на основе стекинга.

В предложенном архиве (train) находится выборка, включающая в себя изображения кошек и собак (по 500 изображений). Имя каждого изображения, для удобства, имеет следующий формат: cat/dog.номер_изображения.jpg в зависимости от того, какое животное присутствует на изображении. Данная выборка используется для обучения классификатора и его оценки.

Следующая выборка (test) предназначена для классификации новых объектов после построения классификатора.

Для работы с изображениями и получения их гистограмм — характеристик распределения интенсивности изображения можно воспользоваться следующей функцией и библиотекой cv2:
```python
def extract_histogram(image, bins=(8, 8, 8)):
    hist = cv2.calcHist([image], [0, 1, 2], None, bins, [0, 256, 0, 256, 0, 256])
    cv2.normalize(hist, hist)
    return hist.flatten()
```
В задачах используйте реализацию алгоритмов из библиотеки sklearn:
```python
from sklearn.ensemble import BaggingClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import LinearSVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import StackingClassifier
```
Обучите базовые алгоритмы на исходном наборе данных (предварительно закодируйте классы: Cat — 1, Dog — 0):
+ Классификатор с мягким зазором и параметрами: ```C = 1.51```, ```random_state = 336```, остальные параметры по умолчанию;
+ Бэггинг деревьев принятия решений. Параметры дерева: ```criterion = 'entropy'```, ```min_samples_leaf = 10```, ```max_leaf_nodes = 20```, ```random_state = 336```, остальные параметры по умолчанию. Параметры бэггинга: ```n_estimators = 21```, ```random_state = 336```;
+ Случайный лес с параметрами: ```n_estimators = 21```, ```criterion = 'entropy'```, ```min_samples_leaf = 10```, ```max_leaf_nodes = 20```, ```random_state = 336```, остальные параметры по умолчанию.

Обучите метаалгоритм — логистическая регрессия: ```solver='lbfgs'```, ```random_state = 336```, остальные параметры по умолчанию. Оцените его точность при ```cv = 2```.

Обучите модель стэкинга. Используйте 2-fold (```cv = 2```) кросс-валидацию для оценки. 

<b>1. Найдите долю правильной классификации (Accuracy)</b>

Выполните предсказание для изображений, указанных ниже

<b>2. Определите вероятность отнесения изображений к классу 1 с помощью обученного метаалгоритма.</b>

![изображение](https://user-images.githubusercontent.com/39648424/199206357-ed639af8-85c4-40cf-aecd-d8a4a5faba56.png)
![изображение](https://user-images.githubusercontent.com/39648424/199206382-50f2a79c-43f6-492f-9b50-11a80a17bbaf.png)



